#! /bin/bash
# date command: MACOS

userdir=$HOME
current_dir=$userdir/bin/

# Clear current weeks
weeks=$current_dir/weeks
true > $weeks

# Set the prompt for the select command
PS3="Select a date or 'q' to quit: "

# Give me the next five weeks starting on Sunday
sundays=( 0 7 14 21 28 35 )
for i in "${sundays[@]}"; do
  echo "$(date -j -v+sun -v+"$i"d +%F)" >> weeks
done

next5weeks=$(cat $weeks)

# Show a menu and ask for input.
select workingSunday in $next5weeks; do
    if [ -n "$workingSunday" ]; then
        echo ${workingSunday}
    fi
    break
done

# set your dates for each post
date_romans=`date -j -f %Y-%m-%d -v+1d $workingSunday +%F`
date_psalms=`date -j -f %Y-%m-%d -v+2d $workingSunday +%F`
date_luke=`date -j -f %Y-%m-%d -v+3d $workingSunday +%F`
date_mark=`date -j -f %Y-%m-%d -v+4d $workingSunday +%F`

# Working directories for posts
content_dir=$userdir/Sites/theologic.us/content/posts

# Working basenames for posts
base_romans=commentary-romans
base_psalms=now-sings-my-soul-psalms
base_luke=family-devos-luke
base_mark=commentary-mark

echo "Publishing for the week of" $workingSunday "!"

read -p "Are you sure? " -n 1 -r
echo
if [[ $REPLY =~ ^[Yy]$ ]]
then
#    cat << EOF > "$content_dir"/x-"$date_romans"-"$base_romans".md
#---
#title: 'xRomans '
#author: Joseph Louthan
#type: post
#publishDate: $date_romans
#url: /$base_romans/$date_romans-$base_romans/
#categories:
#  - Commentary
#tags:
#  - 'Commentary: Romans'
#draft: true
#---
#EOF
    cat << EOF > "$content_dir"/x-"$date_psalms"-"$base_psalms".md
---
title: 'xNow Sings My Soul: Psalm '
author: Joseph Louthan
type: post
publishDate: $date_psalms
url: /$base_psalms/$date_psalms-$base_psalms/
categories:
  - Prayers
tags:
  - 'Now Sings My Soul: Psalms'
draft: true
---
<pre>
<div style="font-variant: small-caps;"></div>

</pre>
EOF
    cat << EOF > "$content_dir"/x-"$date_luke"-"$base_luke".md
---
title: 'xLuke '
author: Joseph Louthan
type: post
publishDate: $date_luke
url: /$base_luke/$date_luke-$base_luke/
categories:
  - Theology
tags:
  - 'Family Devotions: Luke'
draft: true
---
EOF
#    cat << EOF > "$content_dir"/x---"$date_mark"-"$base_mark".md
#---
#title: 'xMark '
#author: Joseph Louthan
#type: post
#publishDate: $date_mark
#url: /$base_mark/$date_mark-$base_mark/
#categories:
#  - Commentary
#tags:
#  - 'Commentary: Mark'
#draft: true
#---
#EOF

fi
